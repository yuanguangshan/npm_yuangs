# yuangs SSH æ™ºèƒ½ç»ˆç«¯

## æ¦‚è¿°

yuangs SSH æ˜¯ä¸€ä¸ªå…·å¤‡ AI æ²»ç†èƒ½åŠ›çš„ SSH å®¢æˆ·ç«¯,å®ç°äº†"å¸¦ AI å®¡è®¡çš„é›¶ä¿¡ä»»å ¡å’æœº"ã€‚

## æ ¸å¿ƒç‰¹æ€§

### âœ… å·²å®ç° (P0 MVP + L2 Audit & Replay)

1. **SSH è¿æ¥ç®¡ç†**
   - æ”¯æŒå¯†ç å’Œç§é’¥è®¤è¯
   - PTY (ä¼ªç»ˆç«¯) æ¨¡å¼
   - çª—å£å°ºå¯¸è‡ªé€‚åº”
   - ä¿¡å·å¤„ç† (Ctrl+C ç­‰)

2. **å‘½ä»¤æ²»ç†**
   - æ‰€æœ‰å‘½ä»¤ç»è¿‡æ²»ç†å±‚å®¡æŸ¥
   - å±é™©å‘½ä»¤è‡ªåŠ¨æ‹¦æˆª
   - sudo/su ææƒçŠ¶æ€æœº
   - å¯†ç æµä¿æŠ¤ (ä¸è¿›å…¥ AI/å®¡è®¡)

3. **å®‰å…¨ç‰¹æ€§**
   - å‘½ä»¤è¾¹ç•Œè¯†åˆ«
   - å®æ—¶é£é™©è¯„ä¼°
   - æ²»ç†å†³ç­–å¯è§†åŒ–
   - **å®¡è®¡æ—¥å¿— (.yuangs.cast æ ¼å¼)**
   - **ä¼šè¯å›æ”¾ (Replay Engine)**

### ğŸ”„ è¿›è¡Œä¸­

- å› æœé”šç‚¹ (Causal Anchor)
- ç­–ç•¥å­¦ä¹  (Policy Learning)

### ğŸ“‹ å¾…å®ç°

- Governance Dashboard (æ²»ç†ä»ªè¡¨ç›˜)
- Human Override (äººç±»ä»‹å…¥ç‚¹)
- æ¢ç´¢æ€§æ”¾è¡Œ (Exploratory Allow)
- å‹‡æ°”ç®¡ç† (Courage Management)

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬è¿æ¥

```bash
# ä½¿ç”¨ç”¨æˆ·å@ä¸»æœºæ ¼å¼
yuangs ssh user@hostname

# æŒ‡å®šç«¯å£
yuangs ssh user@hostname:2222
yuangs ssh user@hostname -p 2222

# ä½¿ç”¨ç§é’¥
yuangs ssh user@hostname -i ~/.ssh/id_rsa

# ä½¿ç”¨å¯†ç  (ä¸æ¨è)
yuangs ssh user@hostname --password yourpassword
```

### é…ç½®æ–‡ä»¶

åˆ›å»º `~/.yuangs/ssh_config.json`:

```json
{
  "hosts": {
    "myserver": {
      "host": "192.168.1.100",
      "port": 22,
      "username": "admin",
      "privateKey": "/Users/you/.ssh/id_rsa"
    },
    "prod-web": {
      "host": "prod-web-01.example.com",
      "port": 22,
      "username": "deploy",
      "privateKey": "/Users/you/.ssh/deploy_key"
    }
  }
}
```

ç„¶åå¯ä»¥ç›´æ¥ä½¿ç”¨:

```bash
yuangs ssh myserver
yuangs ssh prod-web
```

## æ²»ç†åŠŸèƒ½

### å±é™©å‘½ä»¤æ‹¦æˆª

ä»¥ä¸‹å‘½ä»¤ä¼šè¢«è‡ªåŠ¨æ‹¦æˆª:

- `rm -rf /` - åˆ é™¤æ ¹ç›®å½•
- `dd if=... of=/dev/...` - å†™å…¥è®¾å¤‡
- `mkfs` - æ ¼å¼åŒ–
- Fork bomb ç­‰

ç¤ºä¾‹:

```bash
$ yuangs ssh user@host

[ssh] connected to host

$ rm -rf /

ğŸš« [GOVERNANCE BLOCK]
   Reason: Detected potentially destructive command
   Risk Level: R3
   Impact: This command could cause irreversible system damage
```

### sudo/su ææƒç®¡ç†

ææƒçŠ¶æ€æœº:

```
USER â†’ AWAITING_APPROVAL â†’ PENDING_PWD â†’ ROOT
```

- **USER**: æ™®é€šç”¨æˆ·çŠ¶æ€
- **AWAITING_APPROVAL**: ç­‰å¾…æ²»ç†å®¡æ‰¹
- **PENDING_PWD**: å¯†ç è¾“å…¥é˜¶æ®µ (ä¸è®°å½•)
- **ROOT**: å·²è·å¾— Root æƒé™

å¯†ç ä¿æŠ¤:
- å¯†ç è¾“å…¥é˜¶æ®µä¸è¿›å…¥ AI åˆ†æ
- å¯†ç ä¸ä¼šè¢«è®°å½•åˆ°å®¡è®¡æ—¥å¿—
- å¯†ç ä¸ä¼šå‡ºç°åœ¨å›æ”¾ä¸­

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          User / Terminal                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         InputBuffer                     â”‚
â”‚  (å‘½ä»¤è¾¹ç•Œæ¢æµ‹)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    SSHGovernedExecutor                  â”‚
â”‚  (æ²»ç†æ‹¦æˆªå™¨)                            â”‚
â”‚  - sudo/su çŠ¶æ€æœº                        â”‚
â”‚  - å¯†ç æµä¿æŠ¤                            â”‚
â”‚  - é£é™©è¯„ä¼°                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       GovernanceService                 â”‚
â”‚  (æ²»ç†æœåŠ¡)                              â”‚
â”‚  - å±é™©å‘½ä»¤æ£€æµ‹                          â”‚
â”‚  - ç­–ç•¥è¯„ä¼°                              â”‚
â”‚  - é£é™©æŠ«éœ²                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SSHSession                      â”‚
â”‚  (PTY ä»£ç†)                              â”‚
â”‚  - SSH è¿æ¥ç®¡ç†                          â”‚
â”‚  - çª—å£ç®¡ç†                              â”‚
â”‚  - ä¿¡å·å¤„ç†                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Remote Server                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
å­—ç¬¦è¾“å…¥ â†’ InputBuffer â†’ å‘½ä»¤è¯†åˆ«
                            â”‚
                            â–¼
                    å®Œæ•´å‘½ä»¤?
                    â”‚       â”‚
                   å¦       æ˜¯
                    â”‚       â”‚
                    â–¼       â–¼
                ç›´æ¥é€ä¼   æ²»ç†è¯„ä¼°
                    â”‚       â”‚
                    â”‚       â–¼
                    â”‚   å…è®¸/æ‹’ç»
                    â”‚       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”´â†’ SSH Session â†’ è¿œç¨‹æ‰§è¡Œ
```

## å®‰å…¨ä¿è¯

### å¯†ç é›¶æ³„éœ²

âœ… å¯†ç æ°¸ä¸è¿›å…¥:
- AI Planner
- Governance Policy
- Audit Log
- Replay æ•°æ®

### AI æ˜ç¡®çŸ¥é“

âœ… AI èƒ½æ„ŸçŸ¥:
- ä»€ä¹ˆæ—¶å€™åœ¨ç”³è¯·ææƒ
- ä»€ä¹ˆæ—¶å€™å·²ç»æ˜¯ Root
- ä»€ä¹ˆæ—¶å€™ææƒå¤±è´¥

### å¯å®¡è®¡æ€§

âœ… æ‰€æœ‰æ“ä½œ:
- 100% å¯å®¡è®¡
- 100% å¯æ‹’ç»
- 100% å¯å›æ”¾ (å¯†ç é™¤å¤–)

## å¼€å‘è·¯çº¿å›¾

### é˜¶æ®µ P0: MVP âœ…
- [x] SSH è¿æ¥ç®¡ç†
- [x] å‘½ä»¤è¾¹ç•Œè¯†åˆ«
- [x] åŸºç¡€æ²»ç†æ‹¦æˆª
- [x] sudo/su çŠ¶æ€æœº
- [x] å¯†ç æµä¿æŠ¤

### é˜¶æ®µ P1: äº¤äº’å¼ UI
- [ ] xterm.js é›†æˆ
- [ ] AI ä¾§è¾¹æ 
- [ ] æœ¬åœ°/è¿œç¨‹ä¸Šä¸‹æ–‡åŒæ­¥

### é˜¶æ®µ P2: æ²»ç†å‡çº§
- [ ] å®¡è®¡æ—¥å¿— (.yuangs.cast)
- [ ] å›æ”¾å¼•æ“
- [ ] å› æœé”šç‚¹
- [ ] ç­–ç•¥å­¦ä¹ 

### é˜¶æ®µ P3: æŠ€èƒ½è¿ç§»
- [ ] Skill Library è¿œç¨‹æ‰§è¡Œ
- [ ] ç¯å¢ƒå·®å¼‚æ£€æµ‹
- [ ] è‡ªåŠ¨ä¾èµ–å®‰è£…

## æŠ€æœ¯æ ˆ

- **SSH åè®®**: ssh2
- **è¯­è¨€**: TypeScript
- **CLI æ¡†æ¶**: Commander.js
- **æœªæ¥ UI**: xterm.js (è®¡åˆ’ä¸­)

## å‚è€ƒèµ„æ–™

- [å®æ–½è®¡åˆ’](./IMPLEMENTATION_PLAN.md)
- [è¯¦ç»†è®¾è®¡](./todo.md)
- [Terminus](https://github.com/Eugeny/tabby) - ç°ä»£ç»ˆç«¯å‚è€ƒ
- [asciinema](https://asciinema.org/) - å½•åƒæ ¼å¼å‚è€ƒ

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request!

## è®¸å¯è¯

ISC
