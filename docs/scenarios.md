# 场景与命令说明
## Scenarios & Commands

本文件通过一组**真实工程场景**，展示 yuangs 的核心交互范式与执行语义。  
所有示例均遵循以下原则：

> **AI 只负责推理与建议，执行权始终在用户手中。**

---

## 场景 1：阅读与理解代码（只读、无副作用）

### 1.1 引用单个文件

```bash
@src/index.ts
解释这个文件的主要职责
```

**语义说明**

- `@src/index.ts`
  - 显式声明：允许 yuangs 读取该文件内容
  - 行为为只读，不产生任何副作用
- AI 只能基于该文件内容进行分析，不会读取其他文件

**适用场景**

- 快速理解陌生代码
- 新成员 onboarding
- 模块职责确认

---

### 1.2 精确到行号的上下文

```bash
@src/index.ts:42-78
这一段逻辑有没有潜在问题？
```

**语义说明**

- 只暴露指定行号范围
- 非声明行号不会被 AI 感知

**适用场景**

- Code Review
- Bug 定位
- 性能与边界条件分析

---

## 场景 2：项目级结构分析（显式授权）

### 2.1 引入整个目录

```bash
#src/
分析这个目录的模块划分
```

**语义说明**

- `#src/` 明确授权读取该目录下的文件
- 不会扫描未声明的目录
- 不会隐式读取 `.env` 或系统文件

**适用场景**

- 项目接手
- 架构评估
- 文档生成

---

### 2.2 多目录联合分析

```bash
#src/ #packages/
对比这两个目录的职责边界
```

**适用场景**

- Monorepo 架构分析
- 模块拆分或合并前评估

---

## 场景 3：调试与错误分析（上下文 + 输出）

### 3.1 管道输入错误日志

```bash
cat error.log | yuangs "解释这个错误的原因"
```

**语义说明**

- 管道内容作为显式上下文
- AI 不会主动读取任何文件
- 分析过程可完整复现

---

### 3.2 命令 + 输出联合分析

```bash
@!build.sh
```

> `@!` 表示：在用户当前 Shell 语境下运行命令，
> 并将**命令内容 + 实际输出**作为只读上下文挂载给 AI

随后：

```text
为什么会在这里失败？
```

**适用场景**

- 构建失败排查
- CI 日志分析
- 脚本回归问题定位

---

## 场景 4：命令生成（建议而非执行）

### 4.1 生成复杂 Shell 命令

```bash
ai -e "查找当前目录下最近 7 天内修改过的 .log 文件"
```

**语义说明**

- AI 生成建议命令（例如 `find . -name "*.log" -mtime -7`）
- 命令不会自动执行
- 用户可编辑、复制或放弃

---

### 4.2 用户确认后执行

```bash
<Enter>
```

**责任说明**

- 执行前有明确人工确认
- 执行责任完全归属用户

---

## 场景 5：AI 参与，但不干扰确定性脚本

### 5.1 使用 `:exec` 进行原子执行

```bash
:exec ./deploy.sh
```

**语义说明**

- 明确绕过 AI 推理层
- 不生成建议、不解释、不干预

**适用场景**

- 已验证的部署脚本
- CI / 自动化流程
- 高风险、不可被"猜测"的命令

---

## 场景 6：纯思考，不触及系统

### 6.1 作为命令行内的对话窗口

```bash
ai "如何设计一个可审计的执行系统？"
```

**特点**

- 不读取文件
- 不生成命令
- 不产生任何副作用

---

## 场景 7：组合示例（完整工作流）

```bash
#src/
分析整体架构

@src/runtime/exec.ts
这段代码是否违反了副作用隔离原则？

ai -e "给出一个更安全的实现方式"
```

**工作流特征**

1. 上下文由用户逐步显式引入  
2. AI 提供分析与建议  
3. 所有执行点均可见、可审计  

---

## 心智模型速记

以下不是使用技巧，而是 yuangs 的执行契约：

1. **读什么，由我决定（`@` / `#`）**
2. **怎么想，由 AI 协助（`ai` / `ai -e`）**
3. **做不做，永远是我说了算（`Enter` / `:exec`）**

---

## 本文档的定位

本文件不是快速入门教程，而是：

> **yuangs 执行语义的实例化说明书**

它的作用是帮助你在任何场景下，
**准确预期一条输入会带来什么影响，以及不会带来什么影响。**
