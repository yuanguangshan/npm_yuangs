# Yuangs 智能 Git 用户手册 🧠🤖

`yuangs` 为开发者提供了一套完整的“全生命周期”智能 Git 工作流。从理解变更到解决冲突，再到精准提交，AI 深度集成在 Git 的每一个环节。

---

## 🛠️ 核心工具箱概览

| 命令 | 别名 | 功能描述 | 核心价值 |
| :--- | :--- | :--- | :--- |
| `git diff-semantic` | `sd` | 语义级差异分析 | 从函数、类、接口维度理解“改了什么” |
| `git resolve` | - | AI 驱动的冲突解决 | 自动修复合并冲突，带语法校验与备份 |
| `git history-semantic` | `hs` | 语义化历史解析 | 提取提交背后的“真实技术意图”与影响等级 |
| `git smart-commit` | `sc` | 智能分步提交 | 自动识别逻辑块并拆分为多个规范提交 |
| `git commit` | - | 智能消息生成 | 自动生成符合 Conventional Commits 的 Mesage |
| `git review` | - | AI 代码审查 | 多级别（Quick/Deep）代码质量扫描 |

---

## 📖 深度使用指南

### 1. 语义级差异分析 (`git sd`)
传统 `git diff` 关注文本行。`git sd` 关注代码结构。
- **用法**: `yuangs git sd` 或 `yuangs git sd --unstaged`
- **价值**: 快速识别变更是否包含 **Breaking Changes**。如果你删除了一个导出的类或修改了接口签名，它会高亮提醒。

### 2. AI 驱动的冲突解决 (`git resolve`)
当 `merge` 或 `rebase` 产生冲突时使用。
- **用法**: `yuangs git resolve`
- **特性**:
    - **安全性**: 只有通过语法闭合校验（括号匹配、JSON 格式检测）的代码才会被应用。
    - **可靠性**: 自动生成 `.bak` 备份文件。
    - **预览**: 支持 `--dry-run` 模式，只看分析不改文件。
    - **并发**: 通过 `p-limit` 控制 AI 并发，适合处理大规模冲突。

### 3. 语义化历史解析 (`git hs`)
回溯历史时，不再仅仅看到 "fix bug"。
- **用法**: `yuangs git hs -n 5`
- **价值**:
    - **影响等级**: 自动将提交分为 `LOW` / `MEDIUM` / `HIGH` / `BREAKING`。
    - **真实意图**: 结合代码结构变更，重写提交摘要。
    - **趋势总结**: 自动生成最近开发周期的趋势报告。

### 4. 智能分步提交 (`git sc`)
如果你积压了很多修改没提交，`git sc` 是救星。
- **用法**: `yuangs git sc` 或 `yuangs git sc -y` (静默模式)
- **价值**:
    - **逻辑聚类**: 自动识别哪些文件是改 UI 的，哪些是改核心逻辑的。
    - **分步执行**: AI 会建议你拆分成 3-4 个独立的提交，并为每个提交写好规范的 Message。
    - **交互确认**: 你可以逐个确认、编辑消息或跳过。

---

## 💡 最佳实践工作流

### 场景 A：处理复杂变更并提交
```bash
# 1. 先用语义 diff 看看自己对架构的影响
yuangs git sd

# 2. 如果改动太杂，用智能提交来拆分
# 它会识别出你的逻辑块并逐个引导你提交
yuangs git sc
```

### 场景 B：接手他人代码或处理冲突
```bash
# 1. 发生冲突时，让 AI 尝试修复
yuangs git resolve

# 2. 如果不放心，先用 hs 看看前几个人到底改了啥逻辑
yuangs git hs -n 10
```

---

## ⚙️ 配置与调优

你可以通过 `yuangsrc` 或命令参数调整：
- **模型选择**: 推荐使用 `gemini-2.0-flash` (速度快、支持长上下文) 或 `gpt-4o`。
- **并发控制**: 处理多文件冲突时，可用 `-c` 指定并发数。
- **备份开关**: 使用 `--no-backup` 关闭自动备份。

---

**让 Git 配合你的逻辑，而不是让你去配合 Git 的命令行。**
