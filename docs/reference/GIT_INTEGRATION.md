# Git é›†æˆåŠŸèƒ½æ–‡æ¡£

## æ¦‚è¿°

`yuangs` ç°å·²é›†æˆå¼ºå¤§çš„ Git åŠŸèƒ½,æä¾›æ™ºèƒ½ commit message ç”Ÿæˆã€AI ä»£ç å®¡æŸ¥å’Œå¢å¼ºçš„çŠ¶æ€æ˜¾ç¤ºã€‚

## åŠŸèƒ½ç‰¹æ€§

### 1. æ™ºèƒ½ Commit Message ç”Ÿæˆ (`yuangs git commit`)

è‡ªåŠ¨åˆ†æä»£ç å˜æ›´å¹¶ç”Ÿæˆç¬¦åˆ Conventional Commits è§„èŒƒçš„æäº¤ä¿¡æ¯ã€‚

#### åŸºæœ¬ç”¨æ³•

```bash
# åŸºç¡€æäº¤(ä¼šä½¿ç”¨ AI ç”Ÿæˆ message)
yuangs git commit

# æš‚å­˜æ‰€æœ‰å˜æ›´å¹¶æäº¤
yuangs git commit --all

# ç”Ÿæˆè¯¦ç»†çš„ commit message(åŒ…å« body)
yuangs git commit --detailed

# æŒ‡å®š commit ç±»å‹
yuangs git commit --type feat

# æŒ‡å®šå½±å“èŒƒå›´
yuangs git commit --scope router

# é¢„è§ˆæ¨¡å¼(ä¸å®é™…æäº¤)
yuangs git commit --dry-run

# ä¸ä½¿ç”¨ AI,ä½¿ç”¨è§„åˆ™ç”Ÿæˆ
yuangs git commit --no-ai
```

#### é€‰é¡¹è¯´æ˜

- `-a, --all`: è‡ªåŠ¨æš‚å­˜æ‰€æœ‰å˜æ›´
- `-d, --detailed`: ç”ŸæˆåŒ…å«è¯¦ç»† body çš„ commit message
- `-t, --type <type>`: æŒ‡å®š commit ç±»å‹ (feat/fix/docs/style/refactor/perf/test/chore)
- `-s, --scope <scope>`: æŒ‡å®šå½±å“èŒƒå›´
- `--dry-run`: åªç”Ÿæˆ message,ä¸å®é™…æäº¤
- `--no-ai`: ä¸ä½¿ç”¨ AI,ä½¿ç”¨åŸºäºè§„åˆ™çš„ç”Ÿæˆå™¨

#### ç¤ºä¾‹è¾“å‡º

```
âœ” Commit message ç”Ÿæˆå®Œæˆ

ğŸ“ ç”Ÿæˆçš„ Commit Message:

feat(git): æ·»åŠ æ™ºèƒ½ commit message ç”ŸæˆåŠŸèƒ½

- å®ç°åŸºäº AI çš„ commit message ç”Ÿæˆ
- æ”¯æŒ Conventional Commits è§„èŒƒ
- æä¾›è§„åˆ™ç”Ÿæˆä½œä¸º fallback

å˜æ›´ç»Ÿè®¡: 3 ä¸ªæ–‡ä»¶, +245/-12 è¡Œ

âœ” æäº¤æˆåŠŸ!
Commit: a1b2c3d
```

### 2. AI ä»£ç å®¡æŸ¥ (`yuangs git review`)

ä½¿ç”¨ AI å¯¹ä»£ç å˜æ›´è¿›è¡Œå…¨é¢å®¡æŸ¥,å‘ç°æ½œåœ¨é—®é¢˜å¹¶æä¾›æ”¹è¿›å»ºè®®ã€‚

#### åŸºæœ¬ç”¨æ³•

```bash
# æ ‡å‡†å®¡æŸ¥(å®¡æŸ¥å·²æš‚å­˜çš„å˜æ›´)
yuangs git review

# å¿«é€Ÿå®¡æŸ¥(åªçœ‹æ˜æ˜¾é—®é¢˜)
yuangs git review --level quick

# æ·±åº¦å®¡æŸ¥(å…¨é¢åˆ†æ)
yuangs git review --level deep

# å®¡æŸ¥ç‰¹å®šæ–‡ä»¶
yuangs git review --file src/core/git/GitService.ts

# å®¡æŸ¥æœªæš‚å­˜çš„å˜æ›´
yuangs git review --unstaged
```

#### å®¡æŸ¥çº§åˆ«

- `quick`: å¿«é€Ÿæ‰«æ,åªå…³æ³¨æ˜æ˜¾çš„ bugã€å®‰å…¨é—®é¢˜å’Œä¸¥é‡çš„ä»£ç å¼‚å‘³
- `standard`: æ ‡å‡†å®¡æŸ¥,åŒ…æ‹¬ä»£ç è´¨é‡ã€æœ€ä½³å®è·µã€æ½œåœ¨é—®é¢˜(é»˜è®¤)
- `deep`: æ·±åº¦å®¡æŸ¥,åŒ…æ‹¬æ¶æ„è®¾è®¡ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§ç­‰æ‰€æœ‰æ–¹é¢

#### ç¤ºä¾‹è¾“å‡º

```
âœ” ä»£ç å®¡æŸ¥å®Œæˆ

ğŸ” ä»£ç å®¡æŸ¥æŠ¥å‘Š

è¯„åˆ†: 85/100
å®¡æŸ¥æ–‡ä»¶: 3 ä¸ª

ğŸ“‹ æ€»ä½“è¯„ä»·:
  æ•´ä½“ä»£ç è´¨é‡è‰¯å¥½,æœ‰å‡ å¤„éœ€è¦æ”¹è¿›

âš ï¸  å‘ç° 2 ä¸ªé—®é¢˜:

  âš ï¸ [WARNING] src/core/git/GitService.ts:45
     ç¼ºå°‘é”™è¯¯å¤„ç†
     ğŸ’¡ å»ºè®®æ·»åŠ  try-catch å—

  â„¹ï¸ [INFO] src/core/git/CommitMessageGenerator.ts:120
     å¯ä»¥ä¼˜åŒ–æ€§èƒ½
     ğŸ’¡ è€ƒè™‘ä½¿ç”¨ç¼“å­˜æœºåˆ¶

ğŸ‘ ä¼˜ç‚¹:

  âœ“ ä»£ç ç»“æ„æ¸…æ™°
  âœ“ å‘½åè§„èŒƒ
  âœ“ ç±»å‹å®šä¹‰å®Œæ•´

ğŸ’¡ å»ºè®®:

  â€¢ å»ºè®®æ·»åŠ å•å…ƒæµ‹è¯•
  â€¢ è€ƒè™‘æå–å…¬å…±é€»è¾‘
```

### 3. å¢å¼ºçš„ Git çŠ¶æ€ (`yuangs git status`)

æ˜¾ç¤ºæ›´ä¸°å¯Œçš„ Git çŠ¶æ€ä¿¡æ¯,åŒ…æ‹¬åˆ†æ”¯ã€å˜æ›´ç»Ÿè®¡å’Œæœ€è¿‘æäº¤ã€‚

#### åŸºæœ¬ç”¨æ³•

```bash
yuangs git status
```

#### ç¤ºä¾‹è¾“å‡º

```
ğŸ“Š Git çŠ¶æ€

ğŸŒ¿ åˆ†æ”¯:
  å½“å‰: feature/git-integration
  ä¸Šæ¸¸: origin/feature/git-integration
  â†‘ é¢†å…ˆ 2 ä¸ªæäº¤

ğŸ“ å˜æ›´:
  ä¿®æ”¹: 5 ä¸ªæ–‡ä»¶
  æ–°å¢: 3 ä¸ªæ–‡ä»¶
  æœªè·Ÿè¸ª: 1 ä¸ªæ–‡ä»¶

ğŸ“œ æœ€è¿‘æäº¤:

  a1b2c3d feat(git): æ·»åŠ æ™ºèƒ½ commit åŠŸèƒ½
    å¼ ä¸‰ Â· 2026-01-27 22:30:15

  d4e5f6g refactor(core): ä¼˜åŒ–è·¯ç”±é€»è¾‘
    æå›› Â· 2026-01-27 20:15:42
```

## æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

1. **GitService** (`src/core/git/GitService.ts`)
   - æä¾›å®Œæ•´çš„ Git æ“ä½œå°è£…
   - æ”¯æŒ diffã€commitã€branch ç­‰æ‰€æœ‰å¸¸ç”¨æ“ä½œ
   - é”™è¯¯å¤„ç†å’Œå®‰å…¨æ‰§è¡Œ

2. **CommitMessageGenerator** (`src/core/git/CommitMessageGenerator.ts`)
   - AI é©±åŠ¨çš„ commit message ç”Ÿæˆ
   - åŸºäºè§„åˆ™çš„ fallback æœºåˆ¶
   - æ”¯æŒ Conventional Commits è§„èŒƒ

3. **CodeReviewer** (`src/core/git/CodeReviewer.ts`)
   - AI ä»£ç å®¡æŸ¥å¼•æ“
   - å¤šçº§åˆ«å®¡æŸ¥æ”¯æŒ
   - ç»“æ„åŒ–é—®é¢˜æŠ¥å‘Š

### é›†æˆæ–¹å¼

Git åŠŸèƒ½é€šè¿‡ `ModelRouter` ä¸ AI æ¨¡å‹é›†æˆ:

```typescript
const router = getRouter();
const generator = new CommitMessageGenerator(gitService, router);
const reviewer = new CodeReviewer(gitService, router);
```

è¿™ç¡®ä¿äº†:
- è‡ªåŠ¨é€‰æ‹©æœ€é€‚åˆçš„ AI æ¨¡å‹
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒ

## æœ€ä½³å®è·µ

### Commit Message ç”Ÿæˆçš„æœ€ä½³å®è·µ

1. **å§‹ç»ˆåŸºäºæš‚å­˜åŒº**ï¼š`git commit` å‘½ä»¤ä¸¥æ ¼åªåˆ†æå·²æš‚å­˜ï¼ˆstagedï¼‰çš„å˜æ›´ã€‚å¦‚æœåªæœ‰å·¥ä½œåŒºä¿®æ”¹ï¼Œå‘½ä»¤ä¼šå¤±è´¥å¹¶å»ºè®®ä½ ä½¿ç”¨ `git add` æˆ– `--all`ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢æ„å¤–æäº¤æœªå®Œæˆçš„ä»£ç ã€‚

2. **ä½¿ç”¨ --detailed é€‰é¡¹**ç”¨äºé‡è¦åŠŸèƒ½:
   ```bash
   yuangs git commit --detailed --type feat
   ```

### ä»£ç å®¡æŸ¥çš„æœ€ä½³å®è·µ

1. **Deep æ¨¡å¼çš„é™åˆ¶**ï¼šè€ƒè™‘åˆ°æ€§èƒ½å’Œ Token æ¶ˆè€—ï¼Œ`--level deep` æ¨¡å¼å»ºè®®ä»…é’ˆå¯¹æ ¸å¿ƒæ¨¡å—æˆ–ç‰¹å®šæ–‡ä»¶ä½¿ç”¨ã€‚å¦‚æœå˜æ›´æ–‡ä»¶è¶…è¿‡ 20 ä¸ªï¼Œå·¥å…·ä¼šé˜»æ­¢æ‰§è¡Œå¹¶å»ºè®®åˆ‡æ¢åˆ° `standard` æ¨¡å¼æˆ–å®¡æŸ¥ç‰¹å®šæ–‡ä»¶ã€‚

2. **é’ˆå¯¹æ€§å®¡æŸ¥**:
   ```bash
   yuangs git review --file src/critical/module.ts --level deep
   ```

## å·¥ä½œæµç¤ºä¾‹

### å…¸å‹çš„å¼€å‘æµç¨‹

```bash
# 1. æŸ¥çœ‹å½“å‰çŠ¶æ€
yuangs git status

# 2. è¿›è¡Œä»£ç ä¿®æ”¹
# ... ç¼–å†™ä»£ç  ...

# 3. å®¡æŸ¥å˜æ›´
yuangs git review

# 4. æ ¹æ®å®¡æŸ¥å»ºè®®ä¿®æ”¹ä»£ç 
# ... ä¿®å¤é—®é¢˜ ...

# 5. æš‚å­˜å¹¶æäº¤
yuangs git commit --all

# 6. å†æ¬¡æŸ¥çœ‹çŠ¶æ€
yuangs git status
```

### å¿«é€Ÿæäº¤æµç¨‹

```bash
# ä¸€é”®æš‚å­˜ã€ç”Ÿæˆ message å¹¶æäº¤
yuangs git commit --all
```

### è°¨æ…æäº¤æµç¨‹

```bash
# 1. æ·±åº¦å®¡æŸ¥
yuangs git review --level deep

# 2. é¢„è§ˆ commit message
yuangs git commit --dry-run

# 3. ç¡®è®¤åæäº¤
yuangs git commit
```

## æ•…éšœæ’é™¤

### é—®é¢˜: "å½“å‰ç›®å½•ä¸æ˜¯ Git ä»“åº“"

**è§£å†³æ–¹æ¡ˆ**: ç¡®ä¿åœ¨ Git ä»“åº“æ ¹ç›®å½•æˆ–å­ç›®å½•ä¸­è¿è¡Œå‘½ä»¤

```bash
cd /path/to/your/git/repo
yuangs git status
```

### é—®é¢˜: "æ²¡æœ‰å¯æäº¤çš„å˜æ›´"

**è§£å†³æ–¹æ¡ˆ**: å…ˆè¿›è¡Œä¸€äº›ä»£ç ä¿®æ”¹,æˆ–ä½¿ç”¨ `--all` é€‰é¡¹æš‚å­˜å˜æ›´

```bash
# æŸ¥çœ‹å½“å‰å˜æ›´
git status

# æš‚å­˜å˜æ›´
git add .

# æˆ–ä½¿ç”¨ --all é€‰é¡¹
yuangs git commit --all
```

### é—®é¢˜: AI ç”Ÿæˆå¤±è´¥

**è§£å†³æ–¹æ¡ˆ**: ç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°åŸºäºè§„åˆ™çš„ç”Ÿæˆå™¨,æˆ–æ‰‹åŠ¨ä½¿ç”¨ `--no-ai` é€‰é¡¹

```bash
yuangs git commit --no-ai
```

## æœªæ¥è®¡åˆ’

- [ ] æ”¯æŒäº¤äº’å¼ commit message ç¼–è¾‘
- [ ] é›†æˆ Git hooks
- [ ] æ”¯æŒå¤šåˆ†æ”¯å¯¹æ¯”å®¡æŸ¥
- [ ] ç”Ÿæˆ CHANGELOG
- [ ] æ™ºèƒ½å†²çªè§£å†³å»ºè®®
- [ ] Git å·¥ä½œæµæ¨¡æ¿

## æŠ€æœ¯ç»†èŠ‚

### ä¾èµ–

- `ModelRouter`: AI æ¨¡å‹è·¯ç”±å’Œé€‰æ‹©
- `child_process`: Git å‘½ä»¤æ‰§è¡Œ
- `chalk`: ç»ˆç«¯è¾“å‡ºç¾åŒ–
- `ora`: åŠ è½½åŠ¨ç”»

### å®‰å…¨æ€§

- æ‰€æœ‰ Git å‘½ä»¤éƒ½ç»è¿‡å‚æ•°è½¬ä¹‰
- é”™è¯¯ä¿¡æ¯ä¸ä¼šæ³„éœ²æ•æ„Ÿè·¯å¾„
- AI ç”Ÿæˆçš„å†…å®¹ä¼šç»è¿‡éªŒè¯

### æ€§èƒ½

- å¼‚æ­¥æ‰§è¡Œ,ä¸é˜»å¡ä¸»çº¿ç¨‹
- æ™ºèƒ½ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
- å¤§ diff è‡ªåŠ¨æˆªæ–­é¿å…è¶…æ—¶

## è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Request æ¥æ”¹è¿› Git é›†æˆåŠŸèƒ½!
